
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.12. Position Specific Scoring Matrices (PSSMs) &#8212; Topics in Bioinformatics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3ce756a4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=75cd4315"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'seqcomp/pssm';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.14. Odds-ratio’s" href="odds_ratios.html" />
    <link rel="prev" title="6.10. Measuring information using Shannon’s entropy" href="information.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Topics in Bioinformatics</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">1. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Prologue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">3. How to Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notation.html">4. Notation used throughout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">5. Introduction to Python</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">6. Sequence Comparison</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="outline.html">6.1. Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html">6.2. Introduction to Comparison of Biological Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="encoding_information.html">6.3. The role of sequence in encoding life</a></li>
<li class="toctree-l2"><a class="reference internal" href="gene_expression.html">6.4. Gene expression in a nutshell</a></li>

<li class="toctree-l2"><a class="reference internal" href="motifs.html">6.6. <span class="math notranslate nohighlight">\(k\)</span>-mers and Motifs</a></li>

<li class="toctree-l2"><a class="reference internal" href="related_by_function.html">6.8. Experimental procedures for detecting functionally related sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="motif_finding.html">6.9. Finding motifs</a></li>
<li class="toctree-l2"><a class="reference internal" href="information.html">6.10. Measuring information using Shannon’s entropy</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.12. Position Specific Scoring Matrices (PSSMs)</a></li>

<li class="toctree-l2"><a class="reference internal" href="odds_ratios.html">6.14. Odds-ratio’s</a></li>
<li class="toctree-l2"><a class="reference internal" href="dotplot.html">6.15. Dotplot – Alignment of sequences related by descent from a common ancestor</a></li>

<li class="toctree-l2"><a class="reference internal" href="pairwise_alignment.html">6.17. Global Pairwise Alignment Using Dynamic Programming</a></li>

</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../molevol/index.html">7. Molecular Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cogent3/index.html">8. Molecular Evolutionary Analyses Using <code class="docutils literal notranslate"><span class="pre">cogent3</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/index.html">9. Statistical analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../version_control/index.html">10. Introduction to version control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">11. Introduction to Testing in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/GavinHuttley/tib" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/GavinHuttley/tib/edit/main/seqcomp/pssm.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/GavinHuttley/tib/issues/new?title=Issue%20on%20page%20%2Fseqcomp/pssm.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/seqcomp/pssm.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Position Specific Scoring Matrices (PSSMs)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">6.12. Position Specific Scoring Matrices (PSSMs)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-worked-example">6.12.1. A worked example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-expected-under-the-background">6.12.1.1. Calculating the Expected Under the Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-expected-under-the-alternate">6.12.1.2. Calculating the Expected Under the Alternate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusting-the-pwm-with-a-pseudocount">6.12.1.3. Adjusting the PWM with a pseudocount</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-odds-ratio">6.12.1.4. The odds-ratio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-pssm">6.12.1.5. Computing the PSSM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-pssm-score-for-the-sequence">6.12.1.6. Computing the PSSM score for the sequence</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">6.13. Exercises</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<section id="position-specific-scoring-matrices-pssms">
<span id="pssms"></span><h1><span class="section-number">6.12. </span>Position Specific Scoring Matrices (PSSMs)<a class="headerlink" href="#position-specific-scoring-matrices-pssms" title="Link to this heading">#</a></h1>
<p id="index-0">A Position Specific Scoring Matrix, or PSSM, is a matrix of <span class="target" id="index-1"></span>log-odds ratios per position of a sequence motif. (PSSMs are also called <span class="target" id="index-2"></span>profiles.) They provide a means for computing the match odds for any new sequence. They are typically applied to finding transcription factor binding sites (TFBS) but are also used to characterise protein domains.</p>
<p>See <a class="reference internal" href="related_by_function.html#experimental-data"><span class="std std-ref">Experimental procedures for detecting functionally related sequences</span></a> for how the counts data are derived. To illustrate the transformation of those counts data into a PSSM, we will start with a simple worked example. First we take the counts table presented in <a class="reference internal" href="related_by_function.html#pssm-origins"><span class="std std-ref">Transformation of the data for analysis</span></a>.</p>
<p>We convert the <a class="reference internal" href="related_by_function.html#pssm-origins"><span class="std std-ref">PWM</span></a> into a PPM, but I’m restricting the examples to just 4 positions.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<div class="c3table">

<style>
.c3table table {margin: 10px 0;}
.c3table tr:last-child {border-bottom: 1px solid #000;} 
.c3table tr > th {text-align: left; padding: 0 5px;}
.c3table tr > td {text-align: left; padding: 5px;}
.c3table tr:nth-child(even) {background: #f7f7f7 !important;}
.c3table .ellipsis {background: rgba(0, 0, 0, .01);}
.c3table .index {background: rgba(161, 195, 209, 0.0); margin: 10px; font-weight: 600;}
.c3table .head_cell {background: rgba(161, 195, 209, 0.75); font-weight: bold; text-align: center;}
.c3table caption {color: rgb(250, 250, 250); background: rgba(30, 140, 200, 1); padding: 3px; white-space: nowrap; caption-side: top;}
.c3table .cell_title {font-weight: bold;}
.c3col_left { text-align: left !important; display: block;}
.c3col_right { text-align: right !important; display: block;}
.c3col_center { text-align: center !important; display: block;}
</style>

<table>

<caption>
<span class="cell_title">PPM --</span> <br><span class="cell_legend">Position specific probability matrix</span></br>
</caption>
<thead class="head_cell">
<th>Base \ Position</th><th>0</th><th>1</th><th>2</th><th>3</th>
</thead>
<tbody>
<tr><td><span class="c3col_left">T</span></td><td><span class="c3col_right">0.2</span></td><td><span class="c3col_right">1.0</span></td><td><span class="c3col_right">0.1</span></td><td><span class="c3col_right">0.6</span></td></tr>
<tr><td><span class="c3col_left">C</span></td><td><span class="c3col_right">0.0</span></td><td><span class="c3col_right">0.0</span></td><td><span class="c3col_right">0.0</span></td><td><span class="c3col_right">0.0</span></td></tr>
<tr><td><span class="c3col_left">A</span></td><td><span class="c3col_right">0.8</span></td><td><span class="c3col_right">0.0</span></td><td><span class="c3col_right">0.9</span></td><td><span class="c3col_right">0.4</span></td></tr>
<tr><td><span class="c3col_left">G</span></td><td><span class="c3col_right">0.0</span></td><td><span class="c3col_right">0.0</span></td><td><span class="c3col_right">0.0</span></td><td><span class="c3col_right">0.0</span></td></tr>
</tbody>
</table>

</div></div></div>
</div>
<section id="a-worked-example">
<h2><span class="section-number">6.12.1. </span>A worked example<a class="headerlink" href="#a-worked-example" title="Link to this heading">#</a></h2>
<section id="calculating-the-expected-under-the-background">
<h3><span class="section-number">6.12.1.1. </span>Calculating the Expected Under the Background<a class="headerlink" href="#calculating-the-expected-under-the-background" title="Link to this heading">#</a></h3>
<p>Let’s use the sequence</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seq1</span> <span class="o">=</span> <span class="s2">&quot;GTAT&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>We define a background distribution as one where all bases are equally frequent. In the above case, we then obtain the <span class="math notranslate nohighlight">\(p(seq1|background)\)</span> as</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span>
<span class="n">p_seq1_background</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">**</span> <span class="n">seq_len</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p_seq1_background</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>0.003906
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-the-expected-under-the-alternate">
<h3><span class="section-number">6.12.1.2. </span>Calculating the Expected Under the Alternate<a class="headerlink" href="#calculating-the-expected-under-the-alternate" title="Link to this heading">#</a></h3>
<p>In this case, I’m just doing this “manually”. First, note the base order is T, C, A, G <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Here’s a pseudo-code algorithm describing this calculation:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>This ordering of nucleotides is chemical (pyrimidines, then purines) and is the ordering used in some software.</p>
</aside>
</aside>
</aside>
<div class="highlight-rest notranslate"><div class="highlight"><pre><span></span>PPM is a 2D matrix with rows corresponding to bases, columns to positions
define the index order of bases as T at index 0, C index 1, A index 2, G index 3
prob_of_seq = 1.0
for seq_index in sequence
    set base as the character at seq_index
    set base_index as the index of base in bases
    probability_of_base_at_position equals PPM[base_index, seq_index]
    prob_of_seq  = prob_of_seq * probability_of_base_at_position
    if prob_of_seq is 0, exit the loop
</pre></div>
</div>
<p>At sequence position <code class="docutils literal notranslate"><span class="pre">0</span></code>, we have base <code class="docutils literal notranslate"><span class="pre">G</span></code>. This has the value of 0.0, so we stop.</p>
<p>This raises the question of whether a <code class="docutils literal notranslate"><span class="pre">G</span></code> at index <code class="docutils literal notranslate"><span class="pre">[0]</span></code> is truly impossible? More likely, the 0 is due to the sample size of the experiment. One approach is to add a “small” number to all elements. (This is akin to imagining the next observation would have been of the unobserved type.) This number is referred to as a pseudocount and typically, a pseudocount ≤ 1 is chosen.</p>
</section>
<section id="adjusting-the-pwm-with-a-pseudocount">
<h3><span class="section-number">6.12.1.3. </span>Adjusting the PWM with a pseudocount<a class="headerlink" href="#adjusting-the-pwm-with-a-pseudocount" title="Link to this heading">#</a></h3>
<p>We add a pseudocount of 0.5 to the PWM and then convert to a PPM as before, producing</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<div class="c3table">

<style>
.c3table table {margin: 10px 0;}
.c3table tr:last-child {border-bottom: 1px solid #000;} 
.c3table tr > th {text-align: left; padding: 0 5px;}
.c3table tr > td {text-align: left; padding: 5px;}
.c3table tr:nth-child(even) {background: #f7f7f7 !important;}
.c3table .ellipsis {background: rgba(0, 0, 0, .01);}
.c3table .index {background: rgba(161, 195, 209, 0.0); margin: 10px; font-weight: 600;}
.c3table .head_cell {background: rgba(161, 195, 209, 0.75); font-weight: bold; text-align: center;}
.c3table caption {color: rgb(250, 250, 250); background: rgba(30, 140, 200, 1); padding: 3px; white-space: nowrap; caption-side: top;}
.c3table .cell_title {font-weight: bold;}
.c3col_left { text-align: left !important; display: block;}
.c3col_right { text-align: right !important; display: block;}
.c3col_center { text-align: center !important; display: block;}
</style>

<table>

<caption>
<span class="cell_title">PPM</span> <br><span class="cell_legend">Position specific probability matrix after adding 0.5 to the PWM cells</span></br>
</caption>
<thead class="head_cell">
<th>Base \ Position</th><th>0</th><th>1</th><th>2</th><th>3</th>
</thead>
<tbody>
<tr><td><span class="c3col_left">T</span></td><td><span class="c3col_left">0.208</span></td><td><span class="c3col_left">0.875</span></td><td><span class="c3col_left">0.125</span></td><td><span class="c3col_left">0.542</span></td></tr>
<tr><td><span class="c3col_left">C</span></td><td><span class="c3col_left">0.042</span></td><td><span class="c3col_left">0.042</span></td><td><span class="c3col_left">0.042</span></td><td><span class="c3col_left">0.042</span></td></tr>
<tr><td><span class="c3col_left">A</span></td><td><span class="c3col_left">0.708</span></td><td><span class="c3col_left">0.042</span></td><td><span class="c3col_left">0.792</span></td><td><span class="c3col_left">0.375</span></td></tr>
<tr><td><span class="c3col_left">G</span></td><td><span class="c3col_left">0.042</span></td><td><span class="c3col_left">0.042</span></td><td><span class="c3col_left">0.042</span></td><td><span class="c3col_left">0.042</span></td></tr>
</tbody>
</table>
<p>
4 rows x 5 columns</p>
</div></div></div>
</div>
<p>This now leads to the following elements being taken from the table <code class="docutils literal notranslate"><span class="pre">0.042,</span> <span class="pre">0.875,</span> <span class="pre">0.792,</span> <span class="pre">0.542</span></code>, leading to</p>
<div class="math notranslate nohighlight">
\[p(seq1|alternate)=0.042\times0.875\times0.792\times0.542\approx0.015775\]</div>
</section>
<section id="the-odds-ratio">
<h3><span class="section-number">6.12.1.4. </span>The odds-ratio<a class="headerlink" href="#the-odds-ratio" title="Link to this heading">#</a></h3>
<p>We can form an odds-ratio as</p>
<div class="math notranslate nohighlight">
\[OR = \frac{p(seq1|alternate)}{p(seq1|null)}\approx4.0384\]</div>
<p>How should you interpret this? Look at the OR equation!</p>
</section>
<section id="computing-the-pssm">
<h3><span class="section-number">6.12.1.5. </span>Computing the PSSM<a class="headerlink" href="#computing-the-pssm" title="Link to this heading">#</a></h3>
<p>The PSSM is a log-odds matrix, i.e. it’s the log of the odds ratio matrix. Because we assume a background distribution of 0.25, we can compute this very simply as <code class="docutils literal notranslate"><span class="pre">log2(ppm)-log2(0.25)</span></code>.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Maths with logarithms, recall that</p>
<p><span class="math notranslate nohighlight">\(\log(a/b)=\log(a) - \log(b)\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\log(a \times b) = \log(a) + \log(b)\)</span></p>
<p>Note that we use log base 2 (<span class="math notranslate nohighlight">\(\log_2\)</span>), by convention.</p>
</aside>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<div class="c3table">

<style>
.c3table table {margin: 10px 0;}
.c3table tr:last-child {border-bottom: 1px solid #000;} 
.c3table tr > th {text-align: left; padding: 0 5px;}
.c3table tr > td {text-align: left; padding: 5px;}
.c3table tr:nth-child(even) {background: #f7f7f7 !important;}
.c3table .ellipsis {background: rgba(0, 0, 0, .01);}
.c3table .index {background: rgba(161, 195, 209, 0.0); margin: 10px; font-weight: 600;}
.c3table .head_cell {background: rgba(161, 195, 209, 0.75); font-weight: bold; text-align: center;}
.c3table caption {color: rgb(250, 250, 250); background: rgba(30, 140, 200, 1); padding: 3px; white-space: nowrap; caption-side: top;}
.c3table .cell_title {font-weight: bold;}
.c3col_left { text-align: left !important; display: block;}
.c3col_right { text-align: right !important; display: block;}
.c3col_center { text-align: center !important; display: block;}
</style>

<table>

<thead class="head_cell">
<th>Base \ Position</th><th>0</th><th>1</th><th>2</th><th>3</th>
</thead>
<tbody>
<tr><td><span class="c3col_left">T</span></td><td><span class="c3col_right">-0.263</span></td><td><span class="c3col_right">1.807</span></td><td><span class="c3col_right">-1.000</span></td><td><span class="c3col_right">1.115</span></td></tr>
<tr><td><span class="c3col_left">C</span></td><td><span class="c3col_right">-2.585</span></td><td><span class="c3col_right">-2.585</span></td><td><span class="c3col_right">-2.585</span></td><td><span class="c3col_right">-2.585</span></td></tr>
<tr><td><span class="c3col_left">A</span></td><td><span class="c3col_right">1.503</span></td><td><span class="c3col_right">-2.585</span></td><td><span class="c3col_right">1.663</span></td><td><span class="c3col_right">0.585</span></td></tr>
<tr><td><span class="c3col_left">G</span></td><td><span class="c3col_right">-2.585</span></td><td><span class="c3col_right">-2.585</span></td><td><span class="c3col_right">-2.585</span></td><td><span class="c3col_right">-2.585</span></td></tr>
</tbody>
</table>
<p>
4 rows x 5 columns</p>
</div></div></div>
</div>
</section>
<section id="computing-the-pssm-score-for-the-sequence">
<h3><span class="section-number">6.12.1.6. </span>Computing the PSSM score for the sequence<a class="headerlink" href="#computing-the-pssm-score-for-the-sequence" title="Link to this heading">#</a></h3>
<p>We now select elements from the PSSM, just as we did above from the PPM – we use the sequence position number to specify the column of the PSSM, and the base at that position to specify the row. With that, for the sequence “GTAT”, we select the following log-odds scores: <code class="docutils literal notranslate"><span class="pre">-2.585,</span> <span class="pre">1.807,</span> <span class="pre">1.663,</span> <span class="pre">1.115</span></code>.</p>
<p>From these, the log-odds of <code class="docutils literal notranslate"><span class="pre">seq1</span></code> being derived from the experimental sample instead of the bacgkround is:</p>
<div class="math notranslate nohighlight">
\[score = -2.585 + 1.807 + 1.663 + 1.115 = 2\]</div>
<p>For more on the interpretation of odds ratios, see <a class="reference internal" href="odds_ratios.html#odds-ratios"><span class="std std-ref">Odds-ratio’s</span></a>.</p>
</section>
</section>
</section>
<section id="exercises">
<h1><span class="section-number">6.13. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>What does an OR equal 1 mean? What about an OR &gt; 1? Or, an OR&lt;1?</p></li>
<li><p>What does a log-odds ratio &gt; 1 mean? What about a log-odds ratio equal to 0?</p></li>
<li><p>Write a function that takes a numpy array of odds-ratios and returns their <span class="math notranslate nohighlight">\(\log_2\)</span>.</p></li>
<li><p>Write a function that takes a numpy array of log odds-ratios (assume the base is 2, i.e. <span class="math notranslate nohighlight">\(log_2\)</span>) and returns their odds ratios.</p></li>
</ol>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="information.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.10. </span>Measuring information using Shannon’s entropy</p>
      </div>
    </a>
    <a class="right-next"
       href="odds_ratios.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.14. </span>Odds-ratio’s</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">6.12. Position Specific Scoring Matrices (PSSMs)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-worked-example">6.12.1. A worked example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-expected-under-the-background">6.12.1.1. Calculating the Expected Under the Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-expected-under-the-alternate">6.12.1.2. Calculating the Expected Under the Alternate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusting-the-pwm-with-a-pseudocount">6.12.1.3. Adjusting the PWM with a pseudocount</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-odds-ratio">6.12.1.4. The odds-ratio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-pssm">6.12.1.5. Computing the PSSM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-pssm-score-for-the-sequence">6.12.1.6. Computing the PSSM score for the sequence</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">6.13. Exercises</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gavin Huttley
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2024, Gavin Huttley.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>