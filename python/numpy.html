<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.40. numpy – numerical routines for python &mdash; Topics in Bioinformatics 2021.10.15 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.42. Data Visualisation using Plotly" href="visualisation.html" />
    <link rel="prev" title="5.39. Miscellaneous Python features" href="misc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Topics in Bioinformatics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">1. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Prologue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">3. How to Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notation.html">4. Notation used throughout</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">5. Introduction to Python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="resources.html">5.1. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html">5.2. Introduction to programming using Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html">5.3. Computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#code-and-output-in-these-notes-is-from-jupyter">5.4. Code and output in these notes is from Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#everyones-first-program-in-python">5.5. Everyones first program in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#basic-arithmetic-operations">5.6. Basic arithmetic operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#exercises">5.7. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="variables.html">5.8. Variables and assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="variables.html#exercises">5.9. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="operators.html">5.10. Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="operators.html#exercises">5.11. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">5.12. The basic data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html#exercises">5.13. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="logic.html">5.14. Logical syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_errors.html">5.15. Fixing errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_errors.html#exercises">5.16. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html">5.17. Functions and methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#exercises">5.18. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="strings.html">5.19. Dealing with strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="dir_help.html">5.20. Getting help</a></li>
<li class="toctree-l2"><a class="reference internal" href="lists.html">5.21. Using lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="dictionaries.html">5.22. Dealing with dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="sets.html">5.23. The <code class="docutils literal notranslate"><span class="pre">set</span></code> data type</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing.html">5.24. Indexing and Slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing.html#exercises">5.25. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">5.26. Working with files</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html#exercises">5.27. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="iterators.html">5.28. Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="iterators.html#exercises">5.29. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing_functions.html">5.30. Writing functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing_functions.html#exercises">5.31. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace.html">5.32. Namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace.html#exercises">5.33. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="more_looping.html">5.34. More on looping</a></li>
<li class="toctree-l2"><a class="reference internal" href="more_looping.html#exercises">5.35. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="import.html">5.36. Extending capabilities using <code class="docutils literal notranslate"><span class="pre">import</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_write_a_program.html">5.37. Pulling it together – writing your own programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_write_a_program.html#exercises">5.38. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">5.39. Miscellaneous Python features</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.40. <code class="docutils literal notranslate"><span class="pre">numpy</span></code> – numerical routines for python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-an-array-from-existing-data">5.40.1. Creating an array from existing data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-to-standard-python-data-types">5.40.2. Conversion to standard python data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-to-a-different-dtype">5.40.3. Conversion to a different <code class="docutils literal notranslate"><span class="pre">dtype</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#implicit-type-casting">5.40.4. Implicit type casting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-matrices">5.40.5. Constructing matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scalar-operations-on-arrays">5.40.6. Scalar operations on arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-laborious-and-slow-way">5.40.6.1. The laborious (and slow) way</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-simple-and-fast-numpy-way">5.40.6.2. The simple and fast <code class="docutils literal notranslate"><span class="pre">numpy</span></code> way</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#standard-mathematical-operations-on-arrays">5.40.7. Standard mathematical operations on arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array-iteration">5.40.8. Array iteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indexing-and-slicing">5.40.9. Indexing and slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ensuring-array-shapes-are-compatible-for-mathematical-operations">5.40.10. Ensuring array shapes are compatible for mathematical operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array-assignment">5.40.11. Array assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evaluation-operations">5.40.12. Evaluation operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-indexing">5.40.13. Advanced indexing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#boolean-indexing">5.40.13.1. Boolean indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integer-indexing">5.40.13.2. Integer indexing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-numpy-array-axis">5.40.14. The <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-useful-statistical-quantities">5.40.15. Getting useful statistical quantities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linear-algebra-matrix-multiplication">5.40.16. Linear algebra – matrix multiplication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditionals-on-arrays">5.40.17. Conditionals on arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparisons-of-multiple-arrays">5.40.18. Comparisons of multiple arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-result-of-array-comparisons-to-count">5.40.19. Using the result of array comparisons to count</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">5.41. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">5.42. Data Visualisation using Plotly</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html#exercises">5.43. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../seqcomp/index.html">6. Sequence Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molevol/index.html">7. Molecular Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cogent3/index.html">8. Molecular Evolutionary Analyses Using <code class="docutils literal notranslate"><span class="pre">cogent3</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version_control/index.html">9. Introduction to version control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">10. Introduction to Testing in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">11. Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Topics in Bioinformatics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">5. </span>Introduction to Python</a> &raquo;</li>
      <li><span class="section-number">5.40. </span><code class="docutils literal notranslate"><span class="pre">numpy</span></code> – numerical routines for python</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/GavinHuttley/tib/blob/develop/source/python/numpy.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="sidebar" id="numpy-install">
<span id="index-0"></span><p class="sidebar-title">Installing <code class="docutils literal notranslate"><span class="pre">numpy</span></code> on your computer</p>
<p>If you want to use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> on your own computer you will need to install it. How to do so will depend very much on how you have setup Python. If you are not using <code class="docutils literal notranslate"><span class="pre">conda</span></code>, then the following is the safest approach.</p>
<p>In the terminal (either macOS terminal, or the one included with <a class="reference external" href="https://code.visualstudio.com">VS Code</a>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 -m pip install --user numpy
</pre></div>
</div>
</div>
<div class="section" id="numpy-numerical-routines-for-python">
<span id="using-numpy"></span><span id="index-1"></span><h1><span class="section-number">5.40. </span><code class="docutils literal notranslate"><span class="pre">numpy</span></code> – numerical routines for python<a class="headerlink" href="#numpy-numerical-routines-for-python" title="Permalink to this headline"></a></h1>
<p>The <a class="reference external" href="https://numpy.org">numpy</a> library is the foundation of the vast majority of scientific computing packages that use Python. It is popular because it provides a greatly simplified interface to complicated algorithms that have fast implementations. Conventional wisdom holds that converting a standard Python program to use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> will deliver a 10x speedup. In fact, it can be much faster than that. But that’s not the focus of this extremely brief summary of <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. Instead, we introduce you to the major capabilities and usage patterns that <code class="docutils literal notranslate"><span class="pre">numpy</span></code> enables. In short, using <code class="docutils literal notranslate"><span class="pre">numpy</span></code> objects can often eliminated the need for loops entirely. As a consequence, this greatly simplify the algorithms you have to write. So it’s truly worthwhile becoming familiar with this library <a class="footnote-reference brackets" href="#id5" id="id4">3</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>For a visual representation of how operations on arrays work, <a class="reference external" href="http://jalammar.github.io/visual-numpy/">see the excellent visual guide by Jay Alammar</a>.</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> is designed for numerical calculation and the primary object the library provides is an array. The <code class="docutils literal notranslate"><span class="pre">array</span></code> <a class="footnote-reference brackets" href="#id7" id="id6">4</a> object has several key attributes, including:</p>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id6">4</a></span></dt>
<dd><p>Strictly speaking, <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays have type <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> but they are predominantly created using a top-level <code class="docutils literal notranslate"><span class="pre">array</span></code> function.</p>
</dd>
</dl>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">array.ndim</span></code> attribute, which indicates how many dimensions the array has</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">array.shape</span></code> attribute, which indicates the number of elements on each dimension.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">array.dtype</span></code> attribute, which indicates the numpy data type <a class="footnote-reference brackets" href="#id9" id="id8">5</a>. This can also be determined by the input data, or by using the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> argument.</p></li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id8">5</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> extends the range of possible data types, e.g. 8-bit integers, 64-bit floats. <a class="reference external" href="https://numpy.org/doc/stable/user/basics.types.html">See the numpy docs</a> for more details.</p>
</dd>
</dl>
<div class="section" id="creating-an-array-from-existing-data">
<h2><span class="section-number">5.40.1. </span>Creating an array from existing data<a class="headerlink" href="#creating-an-array-from-existing-data" title="Permalink to this headline"></a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([0, 1, 2, 3])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(4,)
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>dtype(&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<p>Once created, you cannot extend an array, i.e. it’s total number of elements is immutable. However, the array “shape” (and thus dimensions) can be changed and the value at individual coordinates can be changed.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0, 1],
       [2, 3]])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[42,  1],
       [ 2,  3]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="conversion-to-standard-python-data-types">
<h2><span class="section-number">5.40.2. </span>Conversion to standard python data types<a class="headerlink" href="#conversion-to-standard-python-data-types" title="Permalink to this headline"></a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">raw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[[42, 1], [2, 3]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="conversion-to-a-different-dtype">
<span id="index-2"></span><h2><span class="section-number">5.40.3. </span>Conversion to a different <code class="docutils literal notranslate"><span class="pre">dtype</span></code><a class="headerlink" href="#conversion-to-a-different-dtype" title="Permalink to this headline"></a></h2>
<p>There is a method on arrays for converting an array of one type into an array of a different type. For instance</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;0.12&quot;</span><span class="p">,</span> <span class="s2">&quot;0.33&quot;</span><span class="p">])</span>
<span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(dtype(&#39;&lt;U4&#39;), array([&#39;0.12&#39;, &#39;0.33&#39;], dtype=&#39;&lt;U4&#39;))
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cast</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">cast</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">cast</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(dtype(&#39;float64&#39;), array([0.12, 0.33]))
</pre></div>
</div>
</div>
</div>
<p>So <code class="docutils literal notranslate"><span class="pre">numpy</span></code> has converted an array of strings into an array of 64-bit precision floats, in one line. Sweet!</p>
</div>
<div class="section" id="implicit-type-casting">
<h2><span class="section-number">5.40.4. </span>Implicit type casting<a class="headerlink" href="#implicit-type-casting" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of an array instance dictates what assignment operations mean. For example, say we have an integer array</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(dtype(&#39;int64&#39;),
 array([[42,  1],
        [ 2,  3]]))
</pre></div>
</div>
</div>
</div>
<p>If we try to assign a <code class="docutils literal notranslate"><span class="pre">float</span></code> to the first element, it will not work because the value is implicitly cast to the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the instance. In this example, only the integer component of the float 5.92132 is assigned.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.92132</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[5, 1],
       [2, 3]])
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Implicit type casting is never what you want! Because <code class="docutils literal notranslate"><span class="pre">numpy</span></code> does not raise an exception for this case, it is up to the programmer (you) to ensure the array <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is appropriate. For this example, if you want to be able to assign floats to <code class="docutils literal notranslate"><span class="pre">data</span></code> you have to convert it to be floats firste, e.g. <code class="docutils literal notranslate"><span class="pre">data.astype(float)</span></code>.</p>
</div>
</div>
<div class="section" id="constructing-matrices">
<h2><span class="section-number">5.40.5. </span>Constructing matrices<a class="headerlink" href="#constructing-matrices" title="Permalink to this headline"></a></h2>
<p>Matrices can be specified on construction by providing, for example, lists of lists. In this example we use a list consisting of two lists, each with 4 elements. This results in a <span class="math notranslate nohighlight">\(2\times4\)</span> array.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(2, 4)
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0, 1, 2, 3],
       [4, 5, 6, 7]])
</pre></div>
</div>
</div>
</div>
<p>Or, by combining other arrays <a class="footnote-reference brackets" href="#id11" id="id10">1</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id10">1</a></span></dt>
<dd><p>I’ve used the <code class="docutils literal notranslate"><span class="pre">numpy.arange()</span></code> function, which returns an <code class="docutils literal notranslate"><span class="pre">array</span></code> object.</p>
</dd>
</dl>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([0, 1, 2, 3])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([4, 5, 6, 7])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># from the above numpy arrays</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0, 1, 2, 3],
       [4, 5, 6, 7]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="scalar-operations-on-arrays">
<span id="index-3"></span><h2><span class="section-number">5.40.6. </span>Scalar operations on arrays<a class="headerlink" href="#scalar-operations-on-arrays" title="Permalink to this headline"></a></h2>
<p>A major convenience for arrays is the ability to express element-wise operations as a single statement, instead of having to use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<p>Here’s an element-wise addition using a standard for loop on the <code class="docutils literal notranslate"><span class="pre">raw</span></code> nested list data structure.</p>
<div class="section" id="the-laborious-and-slow-way">
<h3><span class="section-number">5.40.6.1. </span>The laborious (and slow) way<a class="headerlink" href="#the-laborious-and-slow-way" title="Permalink to this headline"></a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">20</span>
<span class="n">raw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[[62, 21], [22, 23]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-simple-and-fast-numpy-way">
<h3><span class="section-number">5.40.6.2. </span>The simple and fast <code class="docutils literal notranslate"><span class="pre">numpy</span></code> way<a class="headerlink" href="#the-simple-and-fast-numpy-way" title="Permalink to this headline"></a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">+=</span> <span class="mi">20</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[20, 21, 22, 23],
       [24, 25, 26, 27]])
</pre></div>
</div>
</div>
</div>
<p>Nice!</p>
</div>
</div>
<div class="section" id="standard-mathematical-operations-on-arrays">
<h2><span class="section-number">5.40.7. </span>Standard mathematical operations on arrays<a class="headerlink" href="#standard-mathematical-operations-on-arrays" title="Permalink to this headline"></a></h2>
<p>If two or more arrays have the same shape, then element-wise operations between corresponding elements is also very simply expressed.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Before:
[0 1 2 3]
[4 5 6 7]
After:
[ 0  5 12 21]
</pre></div>
</div>
</div>
</div>
<p>If they do not have a compatible shape, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> exception is raised and the text indicates “… operands could not be <span class="target" id="index-4"></span>broadcast together with shapes…”.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">a</span> <span class="o">*</span> <span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_4156</span><span class="o">/</span><span class="mf">3772412408.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">a</span> <span class="o">*</span> <span class="n">d</span>

<span class="ne">ValueError</span>: operands could not be broadcast together with shapes (4,) (5,) 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="array-iteration">
<h2><span class="section-number">5.40.8. </span>Array iteration<a class="headerlink" href="#array-iteration" title="Permalink to this headline"></a></h2>
<p>Behaves the same as iterating over a standard Python list (or tuple) with the same dimensions. This corresponds to <a class="reference internal" href="#numpy-axes"><span class="std std-ref">iterating over axis=0</span></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[20 21 22 23]
[24 25 26 27]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="indexing-and-slicing">
<span id="index-5"></span><h2><span class="section-number">5.40.9. </span>Indexing and slicing<a class="headerlink" href="#indexing-and-slicing" title="Permalink to this headline"></a></h2>
<p>In the following, we are working on this array.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[20, 21, 22, 23],
       [24, 25, 26, 27]])
</pre></div>
</div>
</div>
</div>
<p>We can select an individual element using the standard looking slice notation.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>21
</pre></div>
</div>
</div>
</div>
<p>Note that each dimension requires successive <code class="docutils literal notranslate"><span class="pre">[]</span></code> pairs. The <code class="docutils literal notranslate"><span class="pre">numpy</span></code> extended slicing notation allows using one set of <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>21
</pre></div>
</div>
</div>
</div>
<p>The slicing capabilities of arrays is rich and very useful! We can slice a matrix for a single column across all rows</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># the [1] column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([21, 25])
</pre></div>
</div>
</div>
</div>
<p>or a single row across all columns. In both cases the <code class="docutils literal notranslate"><span class="pre">:</span></code> represents the complete set.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="c1"># the [1] row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([24, 25, 26, 27])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ensuring-array-shapes-are-compatible-for-mathematical-operations">
<span id="index-6"></span><h2><span class="section-number">5.40.10. </span>Ensuring array shapes are compatible for mathematical operations<a class="headerlink" href="#ensuring-array-shapes-are-compatible-for-mathematical-operations" title="Permalink to this headline"></a></h2>
<p>There are rules that <code class="docutils literal notranslate"><span class="pre">numpy</span></code> uses to determine how arrays are broadcast together. The best resource to understanding this is <a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">the official documentation on broadcasting</a>. That said, here’s a very condensed explanation.</p>
<p>When the array shapes are not the same, <code class="docutils literal notranslate"><span class="pre">numpy</span></code> compares the shapes element wise <strong>from right to left</strong>. The dimensions of two arrays are considered compatible when they are same or one of them is 1. Consider the arrays <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0, 1],
       [2, 3],
       [4, 5],
       [6, 7]])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(4, 2)
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">])</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([ 1,  5,  9, 13])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(4,)
</pre></div>
</div>
</div>
</div>
<p>Applying the broadcast rule, these are incompatible.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_4156</span><span class="o">/</span><span class="mf">4205270810.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>

<span class="ne">ValueError</span>: operands could not be broadcast together with shapes (4,2) (4,) 
</pre></div>
</div>
</div>
</div>
<p>This is because, the first value read from the right of <code class="docutils literal notranslate"><span class="pre">x.shape</span></code> is 2 and from the right of <code class="docutils literal notranslate"><span class="pre">y.shape</span></code> is 4.</p>
<p>For our example, one solution that ensures the result of the <code class="docutils literal notranslate"><span class="pre">*</span></code> operation has the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code> is to add a “new axis” to <code class="docutils literal notranslate"><span class="pre">y</span></code>. This can be done via a combination of slicing and using <code class="docutils literal notranslate"><span class="pre">numpy.newaxis</span></code></p>
<div class="jupyter_cell jupyter_container docutils container" id="index-7">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1],
       [10, 15],
       [36, 45],
       [78, 91]])
</pre></div>
</div>
</div>
</div>
<p>or, equivalently, by explicitly reshaping <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1],
       [10, 15],
       [36, 45],
       [78, 91]])
</pre></div>
</div>
</div>
</div>
<p>We could also solve this using the <span class="target" id="index-8"></span>transpose <code class="docutils literal notranslate"><span class="pre">x</span></code> (which flips the matrix, reversing it’s dimensions)</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 0, 10, 36, 78],
       [ 1, 15, 45, 91]])
</pre></div>
</div>
</div>
</div>
<p>but this has the effect of meaning the result is also transposed with respect to the original orientation, which is typically inconvenient.</p>
</div>
<div class="section" id="array-assignment">
<span id="index-9"></span><h2><span class="section-number">5.40.11. </span>Array assignment<a class="headerlink" href="#array-assignment" title="Permalink to this headline"></a></h2>
<p>Consider the following data.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">38</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">93</span><span class="p">],</span> <span class="p">[</span><span class="mi">96</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">70</span><span class="p">]])</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Assignment to individual elements of an array is more flexible than the comparable standard python objects. For instance, to assign <code class="docutils literal notranslate"><span class="pre">0</span></code> to all values of <code class="docutils literal notranslate"><span class="pre">a</span></code> is simply</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0, 0, 0],
       [0, 0, 0]])
</pre></div>
</div>
</div>
</div>
<p>Trying that on a list, however, raises an exception.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">l</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_4156</span><span class="o">/</span><span class="mf">2279759492.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">l</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="ne">TypeError</span>: can only assign an iterable
</pre></div>
</div>
</div>
</div>
<p>As the exception indicates, looping is required.</p>
<p>We can assign to an individual element using the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> notation.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 20,  21,  22,  23],
       [ 24,  25, -99,  27]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluation-operations">
<span id="index-10"></span><h2><span class="section-number">5.40.12. </span>Evaluation operations<a class="headerlink" href="#evaluation-operations" title="Permalink to this headline"></a></h2>
<p>Using standard python evaluation operations on <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays returns element wise <code class="docutils literal notranslate"><span class="pre">bool</span></code> arrays. We show uses for these below.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="n">indices</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[False, False, False, False],
       [False, False,  True, False]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="advanced-indexing">
<span id="index-11"></span><h2><span class="section-number">5.40.13. </span>Advanced indexing<a class="headerlink" href="#advanced-indexing" title="Permalink to this headline"></a></h2>
<p>There are two types of advanced indexing, boolean and integer.</p>
<div class="section" id="boolean-indexing">
<h3><span class="section-number">5.40.13.1. </span>Boolean indexing<a class="headerlink" href="#boolean-indexing" title="Permalink to this headline"></a></h3>
<p>This applies when the object being used to slice the array is of type <code class="docutils literal notranslate"><span class="pre">bool</span></code>. These typically result from some array comparison operation.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2],
       [-3,  4],
       [ 5, -6]])
</pre></div>
</div>
</div>
</div>
<p>Let’s identify all elements that are <span class="math notranslate nohighlight">\(&lt;0\)</span>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">negative</span> <span class="o">=</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="n">negative</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[False, False],
       [ True, False],
       [False,  True]])
</pre></div>
</div>
</div>
</div>
<p>The result is an array with boolean elements indicating whether the corresponding value in <code class="docutils literal notranslate"><span class="pre">m</span></code> satisfied (indicated by <code class="docutils literal notranslate"><span class="pre">True</span></code>) or not (indicated by <code class="docutils literal notranslate"><span class="pre">False</span></code>) the condition (<span class="math notranslate nohighlight">\(&lt;0\)</span>). We can use bool arrays to slice the others with the same shape.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">[</span><span class="n">negative</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([-3, -6])
</pre></div>
</div>
</div>
</div>
<p>As this shows, using a <code class="docutils literal notranslate"><span class="pre">bool</span></code> array for indexing on the original returns just those elements as a flat array. If you want your operation to generate a result with the same shape you need to “index in place”. For instance, you can use the index to restrict specific operations to just those elements represented by the index such as this assignment statement.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">[</span><span class="n">negative</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[1, 2],
       [0, 4],
       [5, 0]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="integer-indexing">
<h3><span class="section-number">5.40.13.2. </span>Integer indexing<a class="headerlink" href="#integer-indexing" title="Permalink to this headline"></a></h3>
<p>This involves as many series of integers as there are dimensions to the array (e.g. 2 in the case of <code class="docutils literal notranslate"><span class="pre">m</span></code>).</p>
<p>Before we start using actual integer series, I’ll start by using conventional indexing to get the value of a single item. Specifically, I select row <code class="docutils literal notranslate"><span class="pre">1</span></code>, column <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">row_index</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">col_index</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">m</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<p>We now enclose those indices in lists, such that each successive value corresponds to another row, another column. As such these sequential arrays correspond to array coordinates and thus must have the same dimension (length in our example below).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">row_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">col_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">m</span><span class="p">[</span><span class="n">row_indices</span><span class="p">,</span> <span class="n">col_indices</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([4, 5, 2])
</pre></div>
</div>
</div>
</div>
<p>This corresponds to the following array coordinates: (1, 1), (2, 0), (0, 1). Thus, the returned value from advanced indexing is an array with same length as the indexing array length (3 in our case).</p>
</div>
</div>
<div class="section" id="the-numpy-array-axis">
<span id="index-12"></span><h2><span class="section-number">5.40.14. </span>The <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array axis<a class="headerlink" href="#the-numpy-array-axis" title="Permalink to this headline"></a></h2>
<div class="sidebar" id="numpy-axes">
<p class="sidebar-title">Numpy arrays and their axis.</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../_images/numpy-axes.png"><img alt="../_images/numpy-axes.png" src="../_images/numpy-axes.png" style="width: 248.4px; height: 266.0px;" /></a>
</div>
<p>An array with <code class="docutils literal notranslate"><span class="pre">shape=(3,2)</span></code>, <code class="docutils literal notranslate"><span class="pre">ndim=2</span></code>. Elements and their array indices are shown as e<span class="math notranslate nohighlight">\(_{i,j}\)</span>. Many array methods have an <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument that applies to arrays with <code class="docutils literal notranslate"><span class="pre">ndim&gt;1</span></code>. In the illustrated example, setting <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> would apply that method along the corresponding axis and generate a result with 2 elements. Setting <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> would generate a result with 3 elements.</p>
</div>
<p><a class="reference internal" href="#numpy-axes"><span class="std std-ref">As illustrated</span></a>, the <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument specifies whether a method / function operates on rows or columns <a class="footnote-reference brackets" href="#id13" id="id12">2</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id12">2</a></span></dt>
<dd><p>You can many more than 2-dimensions with arrays. More dimension means you have more axes and thus larger values of <code class="docutils literal notranslate"><span class="pre">axis</span></code> may be required.</p>
</dd>
</dl>
<p>Working on this array.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 20,  21,  22,  23],
       [ 24,  25, -99,  27]])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([ 44,  46, -77,  50])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="getting-useful-statistical-quantities">
<span id="index-13"></span><h2><span class="section-number">5.40.15. </span>Getting useful statistical quantities<a class="headerlink" href="#getting-useful-statistical-quantities" title="Permalink to this headline"></a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Overall mean, all elements</span>
<span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>7.875
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unbiased estimate of standard deviation, all elements</span>
<span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>43.24163833291109
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Column means, operating on rows</span>
<span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([ 22. ,  23. , -38.5,  25. ])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Row means, operating on columns</span>
<span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([21.5 , -5.75])
</pre></div>
</div>
</div>
</div>
<span class="target" id="index-14"></span></div>
<div class="section" id="linear-algebra-matrix-multiplication">
<span id="index-15"></span><h2><span class="section-number">5.40.16. </span>Linear algebra – matrix multiplication<a class="headerlink" href="#linear-algebra-matrix-multiplication" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Matrix_multiplication">Matrix multiplication</a> is a fundamental operation in linear algebra and is central to many statistical procedures (e.g. fitting linear models, taking the exponential of a matrix, likelihood of a phylogeny).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">ip</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<span class="n">ip</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>38
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol also serves as a special operator for matrix multiplication.</p>
<div class="jupyter_cell jupyter_container docutils container" id="index-16">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">@</span> <span class="n">data2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>38
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="conditionals-on-arrays">
<span id="index-17"></span><h2><span class="section-number">5.40.17. </span>Conditionals on arrays<a class="headerlink" href="#conditionals-on-arrays" title="Permalink to this headline"></a></h2>
<p>Conditional operations on <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays are important. We illustrate the utility of these operations with some simple examples.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">matched</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="n">matched</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[False, False, False,  True],
       [ True, False, False, False]])
</pre></div>
</div>
</div>
</div>
<p>The above expression is evaluated element wise and returns a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array of type <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p>
<p>We use the standard Python <code class="docutils literal notranslate"><span class="pre">in</span></code> operator.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="mi">3</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Yes
</pre></div>
</div>
</div>
</div>
<p>We apply a conditional to an array and use the <code class="docutils literal notranslate"><span class="pre">any()</span></code> method, which will return <code class="docutils literal notranslate"><span class="pre">True</span></code> if any single element satisfied this condition.</p>
<div class="jupyter_cell jupyter_container docutils container" id="index-18">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Yes
</pre></div>
</div>
</div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">all()</span></code> method, which will return <code class="docutils literal notranslate"><span class="pre">True</span></code> only if <strong>all</strong> elements satisfied the condition.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>No
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comparisons-of-multiple-arrays">
<span id="index-19"></span><h2><span class="section-number">5.40.18. </span>Comparisons of multiple arrays<a class="headerlink" href="#comparisons-of-multiple-arrays" title="Permalink to this headline"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> provides tools for element-wise comparisons. This is more complicated than just using the standard python syntax.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Applying equivalence operators to arrays can result in exceptions because the result is ambiguous.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="ow">or</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_4156</span><span class="o">/</span><span class="mf">2595779301.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">x</span> <span class="ow">or</span> <span class="n">y</span>

<span class="ne">ValueError</span>: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</pre></div>
</div>
</div>
</div>
<p>Instead, you should use special functions which will operate element wise. Here’s a couple of examples.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([ True, False, False,  True])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([False, False, False,  True])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="using-the-result-of-array-comparisons-to-count">
<span id="index-20"></span><h2><span class="section-number">5.40.19. </span>Using the result of array comparisons to count<a class="headerlink" href="#using-the-result-of-array-comparisons-to-count" title="Permalink to this headline"></a></h2>
<p>Scenario, you want to count (from multiple arrays that consist of a continuously distributed random variable) the number of times a specific threshold is reached for each “position” on a reference coordinate system.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.923</span><span class="p">,</span> <span class="mf">0.022</span><span class="p">,</span> <span class="mf">0.360</span><span class="p">,</span> <span class="mf">0.970</span><span class="p">,</span> <span class="mf">0.585</span><span class="p">]),</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.480</span><span class="p">,</span> <span class="mf">0.282</span><span class="p">,</span> <span class="mf">0.055</span><span class="p">,</span> <span class="mf">0.873</span><span class="p">,</span> <span class="mf">0.960</span><span class="p">]),</span>
<span class="p">]</span>

<span class="c1"># create an array that will be used to count how often</span>
<span class="c1"># a certain threshold is met</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([0, 0, 0, 0, 0])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">counts</span><span class="p">[</span><span class="n">da</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ True False False  True  True]
</pre></div>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, 2, 2])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, 2, 2])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="exercises">
<h1><span class="section-number">5.41. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline"></a></h1>
<ol class="arabic">
<li><p>Create a list of 10 positive integers and convert it into a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array. Use <code class="docutils literal notranslate"><span class="pre">array</span></code> methods to compute the total. Divide the original array by the total to produce a normalised array, which you assign to a variable <code class="docutils literal notranslate"><span class="pre">freqs</span></code>. Using <code class="docutils literal notranslate"><span class="pre">numpy</span></code> logical operations to show that all elements are between 0 and 1. Use array methods to show the array sum is 1.</p></li>
<li><p>Many methods on <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays have an <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument, one of which is <code class="docutils literal notranslate"><span class="pre">sum()</span></code>. Construct a 2-dimensional (2D) array that has the same number of rows and columns, e.g.</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[0, 0],
 [0, 0]]
</pre></div>
</div>
<p>is a 2D array. Assign values that make it easy to distinguish operations that operate across rows versus those which operate across columns <a class="footnote-reference brackets" href="#id15" id="id14">6</a>. Demonstrate this matrix serves that purpose using <code class="docutils literal notranslate"><span class="pre">sum()</span></code>.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> data types can be summed. Create a sample array with <code class="docutils literal notranslate"><span class="pre">dtype=bool</span></code> and show that the sum of this array equals the number of occurrences of <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p>Look at the array <code class="docutils literal notranslate"><span class="pre">data</span></code> and identify the array coordinates where the values equal 9. Now use advanced array indexing to extract those coordinates in a single line statement.</p>
<blockquote>
<div><div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The result should be</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([9, 9, 9, 9, 9])
</pre></div>
</div>
</div>
</div>
</div></blockquote>
</li>
<li><p>Same as the previous question except in a single line statement extract the values ≠9. The result should be</p>
<blockquote>
<div><div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([1, 0, 3, 2, 8, 2, 1, 3, 1, 5])
</pre></div>
</div>
</div>
</div>
</div></blockquote>
</li>
<li><p>Use boolean array indexing to assign -3 to all values of <code class="docutils literal notranslate"><span class="pre">data</span></code> less than 2. The result should be</p>
<blockquote>
<div><div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[-3,  9, -3,  3,  9],
       [ 9,  2,  8,  2, -3],
       [ 3, -3,  9,  9,  5]])
</pre></div>
</div>
</div>
</div>
</div></blockquote>
</li>
<li><p>For the following boolean array <code class="docutils literal notranslate"><span class="pre">indices</span></code>, what is the result of <code class="docutils literal notranslate"><span class="pre">~indices</span></code>?</p>
<blockquote>
<div><div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div></blockquote>
</li>
<li><p>Convert the following code into using <code class="docutils literal notranslate"><span class="pre">numpy</span></code> – without <code class="docutils literal notranslate"><span class="pre">for</span></code> loops. After converting <code class="docutils literal notranslate"><span class="pre">counts</span></code> to a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array, my solution is 3 lines long.</p>
<blockquote>
<div><div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log10</span>

<span class="n">counts</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
          <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">log10</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[[0, 0.47712125471966244, 0.6020599913279624, 0],
 [0.6020599913279624, 0, 0, 0],
 [0, 0, 0.3010299956639812, 0],
 [0.3010299956639812, 0, 0, 0]]
</pre></div>
</div>
</div>
</div>
<p>The expected result from conversion is</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0.        , 0.47712125, 0.60205999, 0.        , 0.60205999],
       [0.60205999, 0.        , 0.        , 0.        , 0.60205999],
       [0.        , 0.        , 0.30103   , 0.        , 0.47712125],
       [0.30103   , 0.        , 0.        , 0.        , 0.        ]])
</pre></div>
</div>
</div>
</div>
</div></blockquote>
</li>
<li><p>What happens when you slice the following 1D array using <code class="docutils literal notranslate"><span class="pre">newaxis</span></code> on the first axis, or the second axis</p>
<blockquote>
<div><div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div></blockquote>
</li>
<li><p>Comparing performance of pure Python and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> implementations. Investigate usage of <code class="docutils literal notranslate"><span class="pre">numpy.where()</span></code> to obtain the row and column coordinates of a 2D array where the value equals <code class="docutils literal notranslate"><span class="pre">1</span></code> (that’s a one). Write a function called <code class="docutils literal notranslate"><span class="pre">np_where()</span></code> that takes a matrix as an argument and returns the row coordinates and column coordinates.</p>
<blockquote>
<div><p>First, use the following code to generate a random square matrix.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="n">dim</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">dim</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
<span class="n">mat</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="n">mat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[1, 1, 1, 1, 0],
       [1, 1, 1, 0, 0],
       [0, 1, 0, 1, 0],
       [0, 1, 0, 0, 1],
       [0, 0, 0, 0, 0]])
</pre></div>
</div>
</div>
</div>
<p>Compare <code class="docutils literal notranslate"><span class="pre">np_where()</span></code> to the performance of a function implemented using only pure python called <code class="docutils literal notranslate"><span class="pre">py_where()</span></code> that takes the matrix as an argument and returns the <code class="docutils literal notranslate"><span class="pre">&lt;row</span> <span class="pre">coordinates&gt;,</span> <span class="pre">&lt;column</span> <span class="pre">coordinates&gt;</span></code> as lists. For <code class="docutils literal notranslate"><span class="pre">mat</span></code>, it should return the following.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>([0, 0, 0, 0, 1, 1, 1, 2, 2, 3, 3], [0, 1, 2, 3, 0, 1, 2, 1, 3, 1, 4])
</pre></div>
</div>
</div>
</div>
<p>Use the “magic” <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> command builtin to Jupyter to assess performance of each function on the same value of <code class="docutils literal notranslate"><span class="pre">mat</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="n">py_where</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>13.9 µs ± 327 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Then try setting <code class="docutils literal notranslate"><span class="pre">dim=20</span></code> and repeat. Which is faster, and by how much?</p>
</div></blockquote>
</li>
<li><p>Do some googling for testing <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays using <code class="docutils literal notranslate"><span class="pre">assert_allclose</span></code>. Then use this to check your array <code class="docutils literal notranslate"><span class="pre">freqs</span></code> created above sums to 1.</p></li>
</ol>
<dl class="footnote brackets">
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id14">6</a></span></dt>
<dd><p>You want the sum of rows to be different to the sum of columns, that way you know when you have used <code class="docutils literal notranslate"><span class="pre">axis</span></code> correctly.</p>
</dd>
</dl>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="misc.html" class="btn btn-neutral float-left" title="5.39. Miscellaneous Python features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="visualisation.html" class="btn btn-neutral float-right" title="5.42. Data Visualisation using Plotly" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2021, Gavin Huttley.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>